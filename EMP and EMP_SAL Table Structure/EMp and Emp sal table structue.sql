use done;
CREATE DATABASE DEMO;
USE DEMO;
CREATE TABLE EMP
(
EID CHAR(5),
NAME VARCHAR(20),
ADDR VARCHAR(50),
CITY VARCHAR(20),
DOB DATE,
PHONE CHAR(12),
EMAIL VARCHAR(30)
)
SELECT * FROM EMP

INSERT INTO EMP 
VALUES
('E0001', 'VISHAL', 'SECTOR-23, GURUGRAM', 'GURUGRAM', '15-APR-1994', '5548949949', 'JWUCWCI@YAHOO.COM'),
('E0002', 'BDHBHS', 'SREET 2', 'NOIDA', '25-OCT-1995', '39786949', 'ACNWICWUB@GMAIL.COM')


CREATE TABLE EMP_SAL
(
EID CHAR(5),
DEPT VARCHAR(20),
DESI VARCHAR(20),
DOJ DATE,
SALARY INT
)

INSERT INTO EMP_SAL
VALUES
('E0001', 'OPS', 'MANAGER', '14-JUNE-2011', 250000),
('E0002', 'HR', 'DIRECTOR', '30-NOV-2021', 6805425)

SELECT * FROM EMP_SAL;

SELECT * FROM EMP
WHERE NAME LIKE '%HAL%';

UPDATE EMP_SAL
SET SALARY = SALARY + SALARY*0.1
WHERE DESI = 'MANAGER';


INSERT INTO EMP 
VALUES
('E0003', 'PRIYA SINGH', 'BLOCK A, SECTOR-45', 'GURGAON', '05-JUL-1990', '9876543210', 'priya.singh@gmail.com'),
('E0004', 'AMIT KUMAR', 'FLAT 10, DWARKA', 'DELHI', '12-MAR-1988', '8765432190', 'amit.kumar@yahoo.com'),
('E0005', 'ANITA VERMA', 'HOUSE NO 22, ROHINI', 'DELHI', '30-NOV-1992', '7654321980', 'anita.verma@yahoo.co.in'),
('E0006', 'MOHIT MALHOTRA', 'SECTOR 5, VAISHALI', 'GHAZIABAD', '21-DEC-1991', '6543219870', 'mohit.malhotra@gmail.com'),
('E0007', 'SUNITA YADAV', 'GREEN PARK', 'DELHI', '14-AUG-1993', '5432198760', 'sunita.yadav@yahoo.com'),
('E0008', 'RAVI SHARMA', 'MG ROAD', 'GURGAON', '09-JUN-1987', '4321987650', 'ravi.sharma@yahoo.co.in'),
('E0009', 'NEHA ARORA', 'SECTOR 12', 'NOIDA', '18-MAY-1991', '3219876540', 'neha.arora@gmail.com'),
('E0010', 'MANOJ GUPTA', 'SECTOR 50', 'NOIDA', '22-FEB-1994', '2198765430', 'manoj.gupta@yahoo.com');


INSERT INTO EMP_SAL 
VALUES
('E0003', 'FIN', 'ACCOUNTANT', '12-JAN-2015', 180000),
('E0004', 'IT', 'SOFTWARE ENGINEER', '20-AUG-2018', 950000),
('E0005', 'MKT', 'MARKETING MANAGER', '05-MAR-2017', 1200000),
('E0006', 'SALES', 'SALES EXECUTIVE', '15-APR-2019', 750000),
('E0007', 'HR', 'HR EXECUTIVE', '01-JUL-2020', 600000);


---CONSTRAINTS---  ----ASSIGNMENT 3----
USE Demo;

ALTER TABLE EMP
ALTER COLUMN NAME VARCHAR(20) NOT NULL;

ALTER TABLE EMP
ALTER COLUMN EID CHAR(5) NOT NULL;

ALTER TABLE EMP
ADD CONSTRAINT PKID PRIMARY KEY(EID);

ALTER TABLE EMP
ADD CONSTRAINT CHK CHECK(ADDR NOT LIKE '%NAGAR%');

ALTER TABLE EMP
ADD CONSTRAINT CHK_1 CHECK(CITY IN ('GURUGRAM', 'NOIDA', 'GURGAON', 'DELHI', 'GHAZIABAD'))

ALTER TABLE EMP
ADD CONSTRAINT UNI UNIQUE(PHONE)

ALTER TABLE EMP
ADD CONSTRAINT CHK_2 CHECK (EMAIL LIKE '%GMAIL%' OR EMAIL LIKE '%YAHOO%')

ALTER TABLE EMP
ADD CONSTRAINT CHK_3 CHECK (DOB >= '01-JAN-1985')

---EMP SAL---

ALTER TABLE EMP_SAL
ADD CONSTRAINT FKID FOREIGN KEY(EID) REFERENCES EMP(EID);

ALTER TABLE EMP_SAL
ADD CONSTRAINT CHK_4 CHECK (DEPT IN ('HR', 'MIS', 'OPS', 'IT', 'FIN', 'MKT', 'SALES'));

ALTER TABLE EMP_SAL
ADD CONSTRAINT CHK_5 CHECK (DESI IN ('MANAGER', 'DIRECTOR', 'ACCOUNTANT', 'SOFTWARE ENGINEER', 'MARKETING MANAGER', 'SALES EXECUTIVE',
'HR EXECUTIVE'));

ALTER TABLE EMP_SAL
ADD CONSTRAINT DEF DEFAULT 'OPS' FOR DEPT;

ALTER TABLE EMP_SAL
ADD CONSTRAINT CHK_6 CHECK (SALARY >= 10000);

---- ASSIGNMENT 4 ---

SELECT CITY, COUNT(EID) AS 'NO. OF EMPLOYEES'
FROM EMP
GROUP BY CITY
ORDER BY COUNT(EID) DESC;

SELECT CITY, COUNT(EID) AS 'NO. OF EMPLOYEES'
FROM EMP
GROUP BY CITY
ORDER BY 'NO. OF EMPLOYEES' DESC;

SELECT * FROM EMP
WHERE EMAIL NOT LIKE '%YAHOO%';

SELECT DESI, COUNT(EID) AS 'NO. OF EMPLOYEES', SUM(SALARY) AS 'TOTAL COST'
FROM EMP_SAL
GROUP BY DESI
ORDER BY 'TOTAL COST' DESC;

SELECT * FROM EMP_SAL;

